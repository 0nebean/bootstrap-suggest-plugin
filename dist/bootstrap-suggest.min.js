/**
 * bootstrap-suggest-plugin - v0.1.28
 * @description 这是一个基于 bootstrap 按钮式下拉菜单组件的搜索建议插件，必须使用于按钮式下拉菜单组件上。
 * @author lzwme - https://lzw.me
 * @GitHub https://github.com/lzwme/bootstrap-suggest-plugin.git
 * @since 2019-11-15 16:22:39
 */

!function(e){if("function"==typeof define&&define.amd)define(["jquery"],e);else if("object"==typeof exports&&"object"==typeof module)e(require("jquery"));else{if(!window.jQuery)throw new Error("Not found jQuery.");e(window.jQuery)}}(function(v){var c,l=v(window),s="ActiveXObject"in window,e=navigator.userAgent.match(/Chrome\/(\d+)/);e&&(e=+e[1]);var g=s||51<e,p="bsSuggest",h="onDataRequestSuccess",y="disabled",m=!0,w=!1;function b(e){return void 0===e}function x(e){return e.data()}function k(e,t){return b(t)?e.attr("alt"):e.attr("alt",t)}function S(e,t){return void 0!==t?e.attr("data-id",t):e.attr("data-id")}function j(e,t,n){if(t&&t.key){var i,a,r=n.separator||",",o=S(e);n&&n.multiWord?((i=e.val().split(r))[i.length-1]=t.key,o?(a=o.split(r)).push(t.id):a=[t.id],S(e,a.join(r)).val(i.join(r)).focus()):S(e,t.id||"").val(t.key).focus(),e.data("pre-val",e.val()).trigger("onSetSelectValue",[t,(n.data.value||n._lastData.value)[t.index]])}}function C(i,a,e){if(a.is(":visible")){var r=i.parent(),t=r.height(),n=r.width();e.autoDropup&&setTimeout(function(){var e=i.offset().top,t=l.scrollTop(),n=a.height();l.height()+t-e<n&&n+t<e?r.addClass("dropup"):r.removeClass("dropup")},10);var o={};return"left"===e.listAlign?o={left:i.siblings("div").width()-n,right:"auto"}:"right"===e.listAlign&&(o={left:"auto",right:0}),s&&!e.showBtn&&(r.hasClass("dropup")?(o.top="auto",o.bottom=t):(o.top=t,o.bottom="auto")),e.autoMinWidth||(o.minWidth=n),a.css(o),i}}function D(e,t){var n,i,a;if(-1===t.indexId&&!t.idField||t.multiWord)return e;i=t.inputBgColor,a=t.inputWarnColor;var r=e.val(),o=e.data("pre-val");return S(e)||!r?(e.css("background",i||""),!r&&o&&e.trigger("onUnsetSelectValue").data("pre-val","")):(n=e.css("backgroundColor").replace(/ /g,"").split(",",3).join(","),~a.indexOf(n)||e.trigger("onUnsetSelectValue").data("pre-val","").css("background",a)),e}function A(e,t,n){var i,a,r=e.parent().find("tbody tr."+n.listHoverCSS);r.length&&(i=(r.index()+3)*r.height(),(a=+t.css("maxHeight").replace("px",""))<i||t.scrollTop()>a?i-=a:i=0,t.scrollTop(i))}function F(e,t){e.find("tr."+t.listHoverCSS).removeClass(t.listHoverCSS)}function f(e){var t,n=m;for(t in e)if("value"===t){n=w;break}return n?(window.console&&window.console.trace,w):e.value.length?e:w}function T(e,t){var n=t.effectiveFields;return!("__index"===e||n.length&&!~v.inArray(e,n))}function H(e,t,n,i){n.html('<div style="padding:10px 5px 5px">'+e+"</div>").show(),C(t,n,i)}function q(e,t){var n=e.parent().find("ul:eq(0)");n.is(":visible")||(n.show(),e.trigger("onShowDropdown",[t?t.data.value:[]]))}function W(e,t){var n=e.parent().find("ul:eq(0)");n.is(":visible")&&(n.hide(),e.trigger("onHideDropdown",[t?t.data.value:[]]))}function B(e,t,n){var i,a,r,o,l,s,u=e.parent().find("ul:eq(0)"),d=0,f=['<table class="table table-condensed table-sm" style="margin:0">'],c=t.value;if(!t||!(i=c.length))return n.emptyTip?H(n.emptyTip,e,u,n):(u.empty(),W(e,n)),e;if(n._lastData&&JSON.stringify(n._lastData)===JSON.stringify(t)&&u.find("tr").length===i)return q(e,n),C(e,u,n);n._lastData=t;var p,h=n.effectiveFields.length?n.effectiveFields:v.map(c[0],function(e,t){return t});for(n.showHeader&&(f.push("<thead><tr>"),v.each(h,function(e,t){T(t,n)&&(f.push("<th>",n.effectiveFieldsAlias[t]||t,0===e?"("+i+")":"","</th>"),e++)}),f.push("</tr></thead>")),f.push("<tbody>"),a=0;a<i;a++){for(r in d=0,o=[],l=(p=c[a])[n.idField],s=p[n.keyField],p)b(s)&&n.indexKey===d&&(s=p[r]),b(l)&&n.indexId===d&&(l=p[r]),d++;v.each(h,function(e,t){T(t,n)&&o.push('<td data-name="',t,'">',p[t],"</td>")}),f.push('<tr data-index="',p.__index||a,'" data-id="',l,'" data-key="',s,'">',o.join(""),"</tr>")}return f.push("</tbody></table>"),u.html(f.join("")),q(e,n),setTimeout(function(){if(!g){var e=u.find("table:eq(0)"),t=0,n=0;u.height()<e.height()&&+u.css("minWidth").replace("px","")<u.width()&&(t=18,n=20),u.css("paddingRight",t),e.css("marginBottom",n)}},301),C(e,u,n),e}function _(t,n){n=n||"";var e=t._preAjax;e&&e.abort&&4!==e.readyState&&e.abort();var i={type:"GET",dataType:t.jsonp?"jsonp":"json",timeout:5e3};t.jsonp&&(i.jsonp=t.jsonp);var a,r=t.fnAdjustAjaxParam;if(v.isFunction(r)){if(a=r(n,t),w===a)return;v.extend(i,a)}return i.url=function(){if(!n||i.data)return i.url||t.url;var e="?";return/=$/.test(t.url)?e="":/\?/.test(t.url)&&(e="&"),t.url+e+encodeURIComponent(n)}(),t._preAjax=v.ajax(i).done(function(e){t.data=t.fnProcessData(e)}).fail(function(e){t.fnAjaxFail&&t.fnAjaxFail(e,t)})}function U(e,t,n,i){return n=v.trim(n),i.ignorecase&&(e=e.toLocaleLowerCase(),n=n.toLocaleLowerCase()),n&&(T(t,i)||(a=t,r=i,~v.inArray(a,r.searchFields)))&&(~n.indexOf(e)||i.twoWayMatch&&~e.indexOf(n));var a,r}var n={url:null,jsonp:null,data:{value:[]},indexId:0,indexKey:0,idField:"",keyField:"",autoSelect:m,allowNoKeyword:m,getDataMethod:"firstByUrl",delayUntilKeyup:w,ignorecase:w,effectiveFields:[],effectiveFieldsAlias:{},searchFields:[],twoWayMatch:m,multiWord:w,separator:",",delay:300,emptyTip:"",searchingTip:"搜索中...",hideOnSelect:w,autoDropup:w,autoMinWidth:w,showHeader:w,showBtn:m,inputBgColor:"",inputWarnColor:"rgba(255,0,0,.1)",listStyle:{"padding-top":0,"max-height":"375px","max-width":"800px",overflow:"auto",width:"auto",transition:"0.3s","-webkit-transition":"0.3s","-moz-transition":"0.3s","-o-transition":"0.3s","word-break":"keep-all","white-space":"nowrap"},listAlign:"left",listHoverStyle:"background: #07d; color:#fff",listHoverCSS:"jhover",clearable:w,keyLeft:37,keyUp:38,keyRight:39,keyDown:40,keyEnter:13,fnProcessData:function(e){return f(e)},fnGetData:function(e,t,n,i){var a,r,o,l,s={value:[]},u=i.fnPreprocessKeyword;if(e=e||"",v.isFunction(u)&&(e=u(e,i)),i.url){var d;i.searchingTip&&(d=setTimeout(function(){H(i.searchingTip,t,t.parent().find("ul"),i)},600)),_(i,e).done(function(e){n(t,i.data,i),t.trigger(h,e),"firstByUrl"===i.getDataMethod&&(i.url=null)}).always(function(){d&&clearTimeout(d)})}else{if(f(a=i.data))if(e){for(l=a.value.length,r=0;r<l;r++)for(o in a.value[r])if(a.value[r][o]&&U(e,o,a.value[r][o]+"",i)){s.value.push(a.value[r]),s.value[s.value.length-1].__index=r;break}}else s=a;n(t,s,i)}},fnAdjustAjaxParam:null,fnPreprocessKeyword:null,fnAjaxFail:null},i={init:function(f){var t=this;return b((f=f||{}).showHeader)&&f.effectiveFields&&1<f.effectiveFields.length&&(f.showHeader=m),(f=v.extend(m,{},n,f)).processData&&(f.fnProcessData=f.processData),f.getData&&(f.fnGetData=f.getData),"firstByUrl"===f.getDataMethod&&f.url&&!f.delayUntilKeyup&&_(f).done(function(e){f.url=null,t.trigger(h,e)}),v("#"+p).length||v("head:eq(0)").append('<style id="'+p+'">.'+f.listHoverCSS+"{"+f.listHoverStyle+"}</style>"),t.each(function(){var e,n,t,i,a,r,o,l=v(this),s=l.parent(),u=(i=f,a=(t=l).prev("i.clearable"),i.clearable&&!a.length&&(a=v('<i class="clearable glyphicon glyphicon-remove fa fa-plus"></i>').prependTo(t.parent())),a.css({position:"absolute",top:"calc(50% - 6px)",transform:"rotate(45deg)",zIndex:4,cursor:"pointer",width:"14px",lineHeight:"14px",textAlign:"center",fontSize:12}).hide()),d=s.find("ul:eq(0)");(d.parent().css("position","relative"),r=l,o=f,!d.length||r.data(p)?w:(r.data(p,{options:o}),m))&&(f.showBtn||(l.css("borderRadius",4),s.css("width","100%").find(".btn:eq(0)").hide()),l.removeClass(y).prop(y,w).attr("autocomplete","off"),d.css(f.listStyle),f.inputBgColor||(f.inputBgColor=l.css("backgroundColor")),l.on("keydown",function(e){var t,n;if(d.is(":visible")){if(t=d.find("."+f.listHoverCSS),n="",F(d,f),e.keyCode===f.keyDown){if(t.length?t.next().length?n=x(t.next().mouseover()):f.autoSelect&&S(l,"").val(k(l)):n=x(d.find("tbody tr:first").mouseover()),A(l,d,f),!f.autoSelect)return}else if(e.keyCode===f.keyUp){if(t.length?t.prev().length?n=x(t.prev().mouseover()):f.autoSelect&&S(l,"").val(k(l)):n=x(d.find("tbody tr:last").mouseover()),A(l,d,f),!f.autoSelect)return}else e.keyCode===f.keyEnter?(n=x(t),W(l,f)):S(l,"");j(l,n,f)}else S(l,"")}).on("compositionstart",function(e){c=m}).on("compositionend",function(e){c=w}).on("keyup input paste",function(e){var t;e.keyCode&&D(l,f),~v.inArray(e.keyCode,[f.keyDown,f.keyUp,f.keyEnter])?l.val(l.val()):(clearTimeout(n),n=setTimeout(function(){c||(t=l.val(),v.trim(t)&&t===k(l)||(k(l,t),f.multiWord&&(t=t.split(f.separator).reverse()[0]),(t.length||f.allowNoKeyword)&&f.fnGetData(v.trim(t),l,B,f)))},f.delay||300))}).on("focus",function(){C(l,d,f)}).on("blur",function(){e||W(l,f)}).on("click",function(){var e=l.val();if(v.trim(e)&&e===k(l)&&d.find("table tr").length)return q(l,f);d.is(":visible")||(f.multiWord&&(e=e.split(f.separator).reverse()[0]),(e.length||f.allowNoKeyword)&&f.fnGetData(v.trim(e),l,B,f))}),s.find(".btn:eq(0)").attr("data-toggle","").click(function(){if(d.is(":visible"))W(l,f);else{if(f.url){if(l.click().focus(),!d.find("tr").length)return w}else B(l,f.data,f);q(l,f)}return w}),d.mouseenter(function(){e=1,l.blur()}).mouseleave(function(){e=0,l.focus()}).on("mouseenter","tbody tr",function(){return F(d,f),v(this).addClass(f.listHoverCSS),w}).on("mousedown","tbody tr",function(){var e=x(v(this));j(l,e,f),k(l,e.key),D(l,f),f.hideOnSelect&&W(l,f)}),u.length&&(u.click(function(){S(l,"").val(""),D(l,f)}),s.mouseenter(function(){l.prop(y)||u.css("right",f.showBtn?Math.max(l.next().width(),33)+2:12).show()}).mouseleave(function(){u.hide()})))})},show:function(){return this.each(function(){v(this).click()})},hide:function(){return this.each(function(){W(v(this))})},disable:function(){return this.each(function(){v(this).attr(y,m).parent().find(".btn:eq(0)").prop(y,m)})},enable:function(){return this.each(function(){v(this).attr(y,w).parent().find(".btn:eq(0)").prop(y,w)})},destroy:function(){return this.each(function(){v(this).off().removeData(p).removeAttr("style").parent().find(".btn:eq(0)").off().show().attr("data-toggle","dropdown").prop(y,w).next().css("display","").off()})},version:function(){return"0.1.28"}};v.fn[p]=function(e){if("string"==typeof e&&i[e]){var t=m;return this.each(function(){if(!v(this).data(p))return t=w}),t||"init"===e||"version"===e?i[e].apply(this,[].slice.call(arguments,1)):this}return i.init.apply(this,arguments)}});
//# sourceMappingURL=bootstrap-suggest.min.js.map