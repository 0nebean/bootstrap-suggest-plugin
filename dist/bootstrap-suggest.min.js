/**
 * bootstrap-suggest-plugin - v0.1.25
 * @description 这是一个基于 bootstrap 按钮式下拉菜单组件的搜索建议插件，必须使用于按钮式下拉菜单组件上。
 * @author lzwme - https://lzw.me
 * @GitHub https://github.com/lzwme/bootstrap-suggest-plugin.git
 * @since 2018-10-09 17:37:16
 */

!function(e){if("function"==typeof define&&define.amd)define(["jquery"],e);else if("object"==typeof exports&&"object"==typeof module)e(require("jquery"));else{if(!window.jQuery)throw new Error("Not found jQuery.");e(window.jQuery)}}(function(c){var p,l=c(window),s="ActiveXObject"in window,e=navigator.userAgent.match(/Chrome\/(\d+)/);e&&(e=+e[1]);var h=s||51<e,v="bsSuggest",g="onDataRequestSuccess",y="disabled",m=!0,w=!1;function b(e){return e.data()}function x(e,t){return void 0!==t?e.attr("alt",t):e.attr("alt")}function k(e,t){return void 0!==t?e.attr("data-id",t):e.attr("data-id")}function S(e,t,n){if(t&&t.key){var i,o,r=n.separator||",",a=k(e);n&&n.multiWord?((i=e.val().split(r))[i.length-1]=t.key,a?(o=a.split(r)).push(t.id):o=[t.id],k(e,o.join(r)).val(i.join(r)).focus()):k(e,t.id||"").val(t.key).focus(),e.data("pre-val",e.val()).trigger("onSetSelectValue",[t,(n.data.value||n._lastData.value)[t.index]])}}function j(i,o,e){if(o.is(":visible")){var r=i.parent(),t=r.height(),n=r.width();e.autoDropup&&setTimeout(function(){var e=i.offset().top,t=l.scrollTop(),n=o.height();l.height()+t-e<n&&n+t<e?r.addClass("dropup"):r.removeClass("dropup")},10);var a={};return"left"===e.listAlign?a={left:i.siblings("div").width()-n,right:"auto"}:"right"===e.listAlign&&(a={left:"auto",right:0}),s&&!e.showBtn&&(r.hasClass("dropup")?(a.top="auto",a.bottom=t):(a.top=t,a.bottom="auto")),e.autoMinWidth||(a.minWidth=n),o.css(a),i}}function C(e,t){var n,i,o;if(-1===t.indexId&&!t.idField||t.multiWord)return e;i=t.inputBgColor,o=t.inputWarnColor;var r=e.val(),a=e.data("pre-val");return k(e)||!r?(e.css("background",i||""),!r&&a&&e.trigger("onUnsetSelectValue").data("pre-val","")):(n=e.css("backgroundColor").replace(/ /g,"").split(",",3).join(","),~o.indexOf(n)||e.trigger("onUnsetSelectValue").data("pre-val","").css("background",o)),e}function D(e,t,n){var i,o,r=e.parent().find("tbody tr."+n.listHoverCSS);r.length&&(i=(r.index()+3)*r.height(),(o=+t.css("maxHeight").replace("px",""))<i||t.scrollTop()>o?i-=o:i=0,t.scrollTop(i))}function A(e,t){e.find("tr."+t.listHoverCSS).removeClass(t.listHoverCSS)}function f(e){var t,n=m;for(t in e)if("value"===t){n=w;break}return n?(window.console&&window.console.trace,w):e.value.length?e:w}function F(e,t){var n=t.effectiveFields;return!("__index"===e||n.length&&!~c.inArray(e,n))}function T(e,t,n,i){n.html('<div style="padding:10px 5px 5px">'+e+"</div>").show(),j(t,n,i)}function q(e,t){var n=e.parent().find("ul:eq(0)");n.is(":visible")||(n.show(),e.trigger("onShowDropdown",[t?t.data.value:[]]))}function H(e,t){var n=e.parent().find("ul:eq(0)");n.is(":visible")&&(n.hide(),e.trigger("onHideDropdown",[t?t.data.value:[]]))}function W(e,t,n){var i,o,r,a,l,s,u,d=e.parent().find("ul:eq(0)"),f=0,c=['<table class="table table-condensed table-sm" style="margin:0">'],p=t.value;if(!t||!(i=p.length))return n.emptyTip?T(n.emptyTip,e,d,n):(d.empty(),H(e,n)),e;if(n._lastData&&JSON.stringify(n._lastData)===JSON.stringify(t)&&d.find("tr").length===i)return q(e,n),j(e,d,n);if(n._lastData=t,n.showHeader){for(r in c.push("<thead><tr>"),p[0])F(r,n)&&(c.push("<th>",n.effectiveFieldsAlias[r]||r,0===f?"("+i+")":"","</th>"),f++);c.push("</tr></thead>")}for(c.push("<tbody>"),o=0;o<i;o++){for(r in f=0,a=[],l=(u=p[o])[n.idField]||"",s=u[n.keyField]||"",u)s||n.indexKey!==f||(s=u[r]),l||n.indexId!==f||(l=u[r]),f++,F(r,n)&&a.push('<td data-name="',r,'">',u[r],"</td>");c.push('<tr data-index="',u.__index||o,'" data-id="',l,'" data-key="',s,'">',a.join(""),"</tr>")}return c.push("</tbody></table>"),d.html(c.join("")),q(e,n),setTimeout(function(){if(!h){var e=d.find("table:eq(0)"),t=0,n=0;d.height()<e.height()&&+d.css("minWidth").replace("px","")<d.width()&&(t=18,n=20),d.css("paddingRight",t),e.css("marginBottom",n)}},301),j(e,d,n),e}function B(t,n){n=n||"";var e=t._preAjax;e&&e.abort&&4!==e.readyState&&e.abort();var i={type:"GET",dataType:t.jsonp?"jsonp":"json",timeout:5e3};t.jsonp&&(i.jsonp=t.jsonp);var o,r=t.fnAdjustAjaxParam;if(c.isFunction(r)){if(o=r(n,t),w===o)return;c.extend(i,o)}return i.url=function(){if(!n||i.data)return i.url||t.url;var e="?";return/=$/.test(t.url)?e="":/\?/.test(t.url)&&(e="&"),t.url+e+encodeURIComponent(n)}(),t._preAjax=c.ajax(i).done(function(e){t.data=t.fnProcessData(e)}).fail(function(e){t.fnAjaxFail&&t.fnAjaxFail(e,t)})}function _(e,t,n,i){return n=c.trim(n),i.ignorecase&&(e=e.toLocaleLowerCase(),n=n.toLocaleLowerCase()),n&&(F(t,i)||(o=t,r=i,~c.inArray(o,r.searchFields)))&&(~n.indexOf(e)||i.twoWayMatch&&~e.indexOf(n));var o,r}var n={url:null,jsonp:null,data:{value:[]},indexId:0,indexKey:0,idField:"",keyField:"",autoSelect:m,allowNoKeyword:m,getDataMethod:"firstByUrl",delayUntilKeyup:w,ignorecase:w,effectiveFields:[],effectiveFieldsAlias:{},searchFields:[],twoWayMatch:m,multiWord:w,separator:",",delay:300,emptyTip:"",searchingTip:"搜索中...",hideOnSelect:w,autoDropup:w,autoMinWidth:w,showHeader:w,showBtn:m,inputBgColor:"",inputWarnColor:"rgba(255,0,0,.1)",listStyle:{"padding-top":0,"max-height":"375px","max-width":"800px",overflow:"auto",width:"auto",transition:"0.3s","-webkit-transition":"0.3s","-moz-transition":"0.3s","-o-transition":"0.3s"},listAlign:"left",listHoverStyle:"background: #07d; color:#fff",listHoverCSS:"jhover",clearable:w,keyLeft:37,keyUp:38,keyRight:39,keyDown:40,keyEnter:13,fnProcessData:function(e){return f(e)},fnGetData:function(e,t,n,i){var o,r,a,l,s={value:[]},u=i.fnPreprocessKeyword;if(e=e||"",c.isFunction(u)&&(e=u(e,i)),i.url){var d;i.searchingTip&&(d=setTimeout(function(){T(i.searchingTip,t,t.parent().find("ul"),i)},600)),B(i,e).done(function(e){n(t,i.data,i),t.trigger(g,e),"firstByUrl"===i.getDataMethod&&(i.url=null)}).always(function(){d&&clearTimeout(d)})}else{if(f(o=i.data))if(e){for(l=o.value.length,r=0;r<l;r++)for(a in o.value[r])if(o.value[r][a]&&_(e,a,o.value[r][a]+"",i)){s.value.push(o.value[r]),s.value[s.value.length-1].__index=r;break}}else s=o;n(t,s,i)}},fnAdjustAjaxParam:null,fnPreprocessKeyword:null,fnAjaxFail:null},i={init:function(f){var t=this;return void 0===(f=f||{}).showHeader&&f.effectiveFields&&1<f.effectiveFields.length&&(f.showHeader=m),(f=c.extend(m,{},n,f)).processData&&(f.fnProcessData=f.processData),f.getData&&(f.fnGetData=f.getData),"firstByUrl"===f.getDataMethod&&f.url&&!f.delayUntilKeyup&&B(f).done(function(e){f.url=null,t.trigger(g,e)}),c("#"+v).length||c("head:eq(0)").append('<style id="'+v+'">.'+f.listHoverCSS+"{"+f.listHoverStyle+"}</style>"),t.each(function(){var e,n,t,i,o,r,a,l=c(this),s=l.parent(),u=(i=f,o=(t=l).prev("i.clearable"),i.clearable&&!o.length&&(o=c('<i class="clearable glyphicon glyphicon-remove"></i>').prependTo(t.parent())),o.css({position:"absolute",top:12,zIndex:4,cursor:"pointer",fontSize:12}).hide()),d=s.find("ul:eq(0)");(r=l,a=f,!d.length||r.data(v)?w:(r.data(v,{options:a}),m))&&(f.showBtn||(l.css("borderRadius",4),s.css("width","100%").find(".btn:eq(0)").hide()),l.removeClass(y).prop(y,w).attr("autocomplete","off"),d.css(f.listStyle),f.inputBgColor||(f.inputBgColor=l.css("backgroundColor")),l.on("keydown",function(e){var t,n;if(d.is(":visible")){if(t=d.find("."+f.listHoverCSS),n="",A(d,f),e.keyCode===f.keyDown){if(t.length?t.next().length?n=b(t.next().mouseover()):f.autoSelect&&k(l,"").val(x(l)):n=b(d.find("tbody tr:first").mouseover()),D(l,d,f),!f.autoSelect)return}else if(e.keyCode===f.keyUp){if(t.length?t.prev().length?n=b(t.prev().mouseover()):f.autoSelect&&k(l,"").val(x(l)):n=b(d.find("tbody tr:last").mouseover()),D(l,d,f),!f.autoSelect)return}else e.keyCode===f.keyEnter?(n=b(t),H(l,f)):k(l,"");S(l,n,f)}else k(l,"")}).on("compositionstart",function(e){p=m}).on("compositionend",function(e){p=w}).on("keyup input paste",function(e){var t;e.keyCode&&C(l,f),~c.inArray(e.keyCode,[f.keyDown,f.keyUp,f.keyEnter])?l.val(l.val()):(clearTimeout(n),n=setTimeout(function(){p||(t=l.val(),c.trim(t)&&t===x(l)||(x(l,t),f.multiWord&&(t=t.split(f.separator).reverse()[0]),(t.length||f.allowNoKeyword)&&f.fnGetData(c.trim(t),l,W,f)))},f.delay||300))}).on("focus",function(){j(l,d,f)}).on("blur",function(){e||H(l,f)}).on("click",function(){var e=l.val();if(c.trim(e)&&e===x(l)&&d.find("table tr").length)return q(l,f);d.is(":visible")||(f.multiWord&&(e=e.split(f.separator).reverse()[0]),(e.length||f.allowNoKeyword)&&f.fnGetData(c.trim(e),l,W,f))}),s.find(".btn:eq(0)").attr("data-toggle","").click(function(){if(d.is(":visible"))H(l,f);else{if(f.url){if(l.click().focus(),!d.find("tr").length)return w}else W(l,f.data,f);q(l,f)}return w}),d.mouseenter(function(){e=1,l.blur()}).mouseleave(function(){e=0,l.focus()}).on("mouseenter","tbody tr",function(){return A(d,f),c(this).addClass(f.listHoverCSS),w}).on("mousedown","tbody tr",function(){var e=b(c(this));S(l,e,f),x(l,e.key),C(l,f),f.hideOnSelect&&H(l,f)}),u.length&&(u.click(function(){k(l,"").val(""),C(l,f)}),s.mouseenter(function(){l.prop(y)||u.css("right",f.showBtn?Math.max(l.next(".input-group-btn").width(),33)+2:12).show()}).mouseleave(function(){u.hide()})))})},show:function(){return this.each(function(){c(this).click()})},hide:function(){return this.each(function(){H(c(this))})},disable:function(){return this.each(function(){c(this).attr(y,m).parent().find(".btn:eq(0)").prop(y,m)})},enable:function(){return this.each(function(){c(this).attr(y,w).parent().find(".btn:eq(0)").prop(y,w)})},destroy:function(){return this.each(function(){c(this).off().removeData(v).removeAttr("style").parent().find(".btn:eq(0)").off().show().attr("data-toggle","dropdown").prop(y,w).next().css("display","").off()})},version:function(){return"0.1.25"}};c.fn[v]=function(e){if("string"==typeof e&&i[e]){var t=m;return this.each(function(){if(!c(this).data(v))return t=w}),t||"init"===e||"version"===e?i[e].apply(this,[].slice.call(arguments,1)):this}return i.init.apply(this,arguments)}});
//# sourceMappingURL=bootstrap-suggest.min.js.map